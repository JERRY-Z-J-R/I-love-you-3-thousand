{"remainingRequest":"F:\\MyGit\\Jerry-Blog\\小程序与主流框架开发\\Vue\\4、Vue 项目实战\\jingdong\\node_modules\\babel-loader\\lib\\index.js!F:\\MyGit\\Jerry-Blog\\小程序与主流框架开发\\Vue\\4、Vue 项目实战\\jingdong\\node_modules\\eslint-loader\\index.js??ref--14-0!F:\\MyGit\\Jerry-Blog\\小程序与主流框架开发\\Vue\\4、Vue 项目实战\\jingdong\\src\\effects\\cartEffects.js","dependencies":[{"path":"F:\\MyGit\\Jerry-Blog\\小程序与主流框架开发\\Vue\\4、Vue 项目实战\\jingdong\\src\\effects\\cartEffects.js","mtime":1607014250000},{"path":"F:\\MyGit\\Jerry-Blog\\小程序与主流框架开发\\Vue\\4、Vue 项目实战\\jingdong\\babel.config.js","mtime":1592841392000},{"path":"F:\\MyGit\\Jerry-Blog\\小程序与主流框架开发\\Vue\\4、Vue 项目实战\\jingdong\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1640280676865},{"path":"F:\\MyGit\\Jerry-Blog\\小程序与主流框架开发\\Vue\\4、Vue 项目实战\\jingdong\\node_modules\\babel-loader\\lib\\index.js","mtime":1640280678474},{"path":"F:\\MyGit\\Jerry-Blog\\小程序与主流框架开发\\Vue\\4、Vue 项目实战\\jingdong\\node_modules\\eslint-loader\\index.js","mtime":1640280677296}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLnRvLWZpeGVkLmpzIjsKaW1wb3J0IHsgY29tcHV0ZWQgfSBmcm9tICd2dWUnOwppbXBvcnQgeyB1c2VTdG9yZSB9IGZyb20gJ3Z1ZXgnOyAvLyDotK3nianovabnm7jlhbPpgLvovpEKCmV4cG9ydCB2YXIgdXNlQ29tbW9uQ2FydEVmZmVjdCA9IGZ1bmN0aW9uIHVzZUNvbW1vbkNhcnRFZmZlY3Qoc2hvcElkKSB7CiAgdmFyIHN0b3JlID0gdXNlU3RvcmUoKTsKICB2YXIgY2FydExpc3QgPSBzdG9yZS5zdGF0ZS5jYXJ0TGlzdDsKCiAgdmFyIGNoYW5nZUNhcnRJdGVtSW5mbyA9IGZ1bmN0aW9uIGNoYW5nZUNhcnRJdGVtSW5mbyhzaG9wSWQsIHByb2R1Y3RJZCwgcHJvZHVjdEluZm8sIG51bSkgewogICAgc3RvcmUuY29tbWl0KCdjaGFuZ2VDYXJ0SXRlbUluZm8nLCB7CiAgICAgIHNob3BJZDogc2hvcElkLAogICAgICBwcm9kdWN0SWQ6IHByb2R1Y3RJZCwKICAgICAgcHJvZHVjdEluZm86IHByb2R1Y3RJbmZvLAogICAgICBudW06IG51bQogICAgfSk7CiAgfTsKCiAgdmFyIHByb2R1Y3RMaXN0ID0gY29tcHV0ZWQoZnVuY3Rpb24gKCkgewogICAgdmFyIF9jYXJ0TGlzdCRzaG9wSWQ7CgogICAgdmFyIHByb2R1Y3RMaXN0ID0gKChfY2FydExpc3Qkc2hvcElkID0gY2FydExpc3Rbc2hvcElkXSkgPT09IG51bGwgfHwgX2NhcnRMaXN0JHNob3BJZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NhcnRMaXN0JHNob3BJZC5wcm9kdWN0TGlzdCkgfHwge307CiAgICB2YXIgbm90RW1wdHlQcm9kdWN0TGlzdCA9IHt9OwoKICAgIGZvciAodmFyIGkgaW4gcHJvZHVjdExpc3QpIHsKICAgICAgdmFyIHByb2R1Y3QgPSBwcm9kdWN0TGlzdFtpXTsKCiAgICAgIGlmIChwcm9kdWN0LmNvdW50ID4gMCkgewogICAgICAgIG5vdEVtcHR5UHJvZHVjdExpc3RbaV0gPSBwcm9kdWN0OwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG5vdEVtcHR5UHJvZHVjdExpc3Q7CiAgfSk7CiAgdmFyIHNob3BOYW1lID0gY29tcHV0ZWQoZnVuY3Rpb24gKCkgewogICAgdmFyIF9jYXJ0TGlzdCRzaG9wSWQyOwoKICAgIHZhciBzaG9wTmFtZSA9ICgoX2NhcnRMaXN0JHNob3BJZDIgPSBjYXJ0TGlzdFtzaG9wSWRdKSA9PT0gbnVsbCB8fCBfY2FydExpc3Qkc2hvcElkMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NhcnRMaXN0JHNob3BJZDIuc2hvcE5hbWUpIHx8ICcnOwogICAgcmV0dXJuIHNob3BOYW1lOwogIH0pOwogIHZhciBjYWxjdWxhdGlvbnMgPSBjb21wdXRlZChmdW5jdGlvbiAoKSB7CiAgICB2YXIgX2NhcnRMaXN0JHNob3BJZDM7CgogICAgdmFyIHByb2R1Y3RMaXN0ID0gKF9jYXJ0TGlzdCRzaG9wSWQzID0gY2FydExpc3Rbc2hvcElkXSkgPT09IG51bGwgfHwgX2NhcnRMaXN0JHNob3BJZDMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jYXJ0TGlzdCRzaG9wSWQzLnByb2R1Y3RMaXN0OwogICAgdmFyIHJlc3VsdCA9IHsKICAgICAgdG90YWw6IDAsCiAgICAgIHByaWNlOiAwLAogICAgICBhbGxDaGVja2VkOiB0cnVlCiAgICB9OwoKICAgIGlmIChwcm9kdWN0TGlzdCkgewogICAgICBmb3IgKHZhciBpIGluIHByb2R1Y3RMaXN0KSB7CiAgICAgICAgdmFyIHByb2R1Y3QgPSBwcm9kdWN0TGlzdFtpXTsKICAgICAgICByZXN1bHQudG90YWwgKz0gcHJvZHVjdC5jb3VudDsKCiAgICAgICAgaWYgKHByb2R1Y3QuY2hlY2spIHsKICAgICAgICAgIHJlc3VsdC5wcmljZSArPSBwcm9kdWN0LmNvdW50ICogcHJvZHVjdC5wcmljZTsKICAgICAgICB9CgogICAgICAgIGlmIChwcm9kdWN0LmNvdW50ID4gMCAmJiAhcHJvZHVjdC5jaGVjaykgewogICAgICAgICAgcmVzdWx0LmFsbENoZWNrZWQgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXN1bHQucHJpY2UgPSByZXN1bHQucHJpY2UudG9GaXhlZCgyKTsKICAgIHJldHVybiByZXN1bHQ7CiAgfSk7CiAgcmV0dXJuIHsKICAgIGNhcnRMaXN0OiBjYXJ0TGlzdCwKICAgIHNob3BOYW1lOiBzaG9wTmFtZSwKICAgIHByb2R1Y3RMaXN0OiBwcm9kdWN0TGlzdCwKICAgIGNhbGN1bGF0aW9uczogY2FsY3VsYXRpb25zLAogICAgY2hhbmdlQ2FydEl0ZW1JbmZvOiBjaGFuZ2VDYXJ0SXRlbUluZm8KICB9Owp9Ow=="},{"version":3,"sources":["F:/MyGit/Jerry-Blog/小程序与主流框架开发/Vue/4、Vue 项目实战/jingdong/src/effects/cartEffects.js"],"names":["computed","useStore","useCommonCartEffect","shopId","store","cartList","state","changeCartItemInfo","productId","productInfo","num","commit","productList","notEmptyProductList","i","product","count","shopName","calculations","result","total","price","allChecked","check","toFixed"],"mappings":";AAAA,SAASA,QAAT,QAAyB,KAAzB;AACA,SAASC,QAAT,QAAyB,MAAzB,C,CACA;;AACA,OAAO,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACC,MAAD,EAAY;AAC7C,MAAMC,KAAK,GAAGH,QAAQ,EAAtB;AACA,MAAMI,QAAQ,GAAGD,KAAK,CAACE,KAAN,CAAYD,QAA7B;;AACA,MAAME,kBAAkB,GAAG,SAArBA,kBAAqB,CAACJ,MAAD,EAASK,SAAT,EAAoBC,WAApB,EAAiCC,GAAjC,EAAyC;AAClEN,IAAAA,KAAK,CAACO,MAAN,CAAa,oBAAb,EAAmC;AACjCR,MAAAA,MAAM,EAANA,MADiC;AACzBK,MAAAA,SAAS,EAATA,SADyB;AACdC,MAAAA,WAAW,EAAXA,WADc;AACDC,MAAAA,GAAG,EAAHA;AADC,KAAnC;AAGD,GAJD;;AAMA,MAAME,WAAW,GAAGZ,QAAQ,CAAC,YAAM;AAAA;;AACjC,QAAMY,WAAW,GAAG,qBAAAP,QAAQ,CAACF,MAAD,CAAR,sEAAkBS,WAAlB,KAAiC,EAArD;AACA,QAAMC,mBAAmB,GAAG,EAA5B;;AACA,SAAI,IAAIC,CAAR,IAAaF,WAAb,EAA0B;AACxB,UAAMG,OAAO,GAAGH,WAAW,CAACE,CAAD,CAA3B;;AACA,UAAGC,OAAO,CAACC,KAAR,GAAgB,CAAnB,EAAuB;AACrBH,QAAAA,mBAAmB,CAACC,CAAD,CAAnB,GAAyBC,OAAzB;AACD;AACF;;AACD,WAAOF,mBAAP;AACD,GAV2B,CAA5B;AAYA,MAAMI,QAAQ,GAAGjB,QAAQ,CAAC,YAAM;AAAA;;AAC9B,QAAMiB,QAAQ,GAAG,sBAAAZ,QAAQ,CAACF,MAAD,CAAR,wEAAkBc,QAAlB,KAA8B,EAA/C;AACA,WAAOA,QAAP;AACD,GAHwB,CAAzB;AAKA,MAAMC,YAAY,GAAGlB,QAAQ,CAAC,YAAM;AAAA;;AAClC,QAAMY,WAAW,wBAAGP,QAAQ,CAACF,MAAD,CAAX,sDAAG,kBAAkBS,WAAtC;AACA,QAAMO,MAAM,GAAG;AAAEC,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,KAAK,EAAE,CAAnB;AAAsBC,MAAAA,UAAU,EAAE;AAAlC,KAAf;;AACA,QAAGV,WAAH,EAAgB;AACb,WAAI,IAAIE,CAAR,IAAaF,WAAb,EAA0B;AACxB,YAAMG,OAAO,GAAGH,WAAW,CAACE,CAAD,CAA3B;AACAK,QAAAA,MAAM,CAACC,KAAP,IAAgBL,OAAO,CAACC,KAAxB;;AACA,YAAGD,OAAO,CAACQ,KAAX,EAAkB;AAChBJ,UAAAA,MAAM,CAACE,KAAP,IAAiBN,OAAO,CAACC,KAAR,GAAgBD,OAAO,CAACM,KAAzC;AACD;;AACD,YAAGN,OAAO,CAACC,KAAR,GAAgB,CAAhB,IAAqB,CAACD,OAAO,CAACQ,KAAjC,EAAwC;AACtCJ,UAAAA,MAAM,CAACG,UAAP,GAAoB,KAApB;AACD;AACH;AACF;;AACDH,IAAAA,MAAM,CAACE,KAAP,GAAeF,MAAM,CAACE,KAAP,CAAaG,OAAb,CAAqB,CAArB,CAAf;AACA,WAAOL,MAAP;AACD,GAjB4B,CAA7B;AAmBA,SAAO;AAAEd,IAAAA,QAAQ,EAARA,QAAF;AAAYY,IAAAA,QAAQ,EAARA,QAAZ;AAAsBL,IAAAA,WAAW,EAAXA,WAAtB;AAAmCM,IAAAA,YAAY,EAAZA,YAAnC;AAAiDX,IAAAA,kBAAkB,EAAlBA;AAAjD,GAAP;AACD,CA9CM","sourcesContent":["import { computed } from 'vue'\nimport { useStore } from 'vuex'\n// 购物车相关逻辑\nexport const useCommonCartEffect = (shopId) => {\n  const store = useStore()\n  const cartList = store.state.cartList;\n  const changeCartItemInfo = (shopId, productId, productInfo, num) => {\n    store.commit('changeCartItemInfo', {\n      shopId, productId, productInfo, num\n    })\n  }\n  \n  const productList = computed(() => {\n    const productList = cartList[shopId]?.productList || {}\n    const notEmptyProductList = {}\n    for(let i in productList) {\n      const product = productList[i]\n      if(product.count > 0 ) {\n        notEmptyProductList[i] = product\n      }\n    }\n    return notEmptyProductList\n  })\n\n  const shopName = computed(() => {\n    const shopName = cartList[shopId]?.shopName || ''\n    return shopName\n  })\n\n  const calculations = computed(() => {\n    const productList = cartList[shopId]?.productList\n    const result = { total: 0, price: 0, allChecked: true}\n    if(productList) {\n       for(let i in productList) {\n         const product = productList[i]\n         result.total += product.count\n         if(product.check) {\n           result.price += (product.count * product.price)\n         }\n         if(product.count > 0 && !product.check) {\n           result.allChecked = false\n         }\n      }\n    }\n    result.price = result.price.toFixed(2)\n    return result\n  })\n\n  return { cartList, shopName, productList, calculations, changeCartItemInfo }\n}"]}]}